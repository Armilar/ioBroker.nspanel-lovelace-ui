{
  "version": 3,
  "sources": ["../../../src/lib/classes/http-server.ts"],
  "sourcesContent": ["import http from 'http';\nimport { BaseClass } from './library';\nimport type { NspanelLovelaceUi } from '../types/NspanelLovelaceUi';\nimport fs from 'fs';\n\nexport class HttpServer extends BaseClass {\n    server: http.Server;\n    constructor(adapter: NspanelLovelaceUi, name: string, ip: string, port: number, fileName: string) {\n        super(adapter, name);\n        this.log.debug(`Starting http server on ${ip}:${port} to serve ${fileName}`);\n        this.server = http\n            .createServer((req, res) => {\n                this.log.debug(`Request received: ${req.url}`);\n                res.setHeader('Access-Control-Allow-Methods', 'GET, POST, OPTIONS, PUT, PATCH, DELETE');\n\n                fs.readFile(fileName + req.url, (err, data) => {\n                    if (err) {\n                        res.writeHead(404);\n                        res.write('File not found!', err => {\n                            if (err) {\n                                this.adapter.log.error(`Error writing file: ${err}`);\n                            }\n                            res.end();\n                            //void this.delete();\n                        });\n                    } else {\n                        res.writeHead(200, {\n                            'Content-Type': 'application/octet-stream',\n                            'Content-Length': data.byteLength,\n                            'Accept-Ranges': 'bytes',\n                        });\n                        res.write(data, err => {\n                            if (err) {\n                                this.adapter.log.error(`Error writing file: ${err}`);\n                            }\n                            res.end();\n                            //void this.delete();\n                        });\n                    }\n                });\n            })\n            .listen(port, ip);\n    }\n    async delete(): Promise<void> {\n        this.log.debug('Closing http server');\n        this.server.close();\n    }\n}\n"],
  "mappings": ";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,kBAAiB;AACjB,qBAA0B;AAE1B,gBAAe;AAER,MAAM,mBAAmB,yBAAU;AAAA,EACtC;AAAA,EACA,YAAY,SAA4B,MAAc,IAAY,MAAc,UAAkB;AAC9F,UAAM,SAAS,IAAI;AACnB,SAAK,IAAI,MAAM,2BAA2B,EAAE,IAAI,IAAI,aAAa,QAAQ,EAAE;AAC3E,SAAK,SAAS,YAAAA,QACT,aAAa,CAAC,KAAK,QAAQ;AACxB,WAAK,IAAI,MAAM,qBAAqB,IAAI,GAAG,EAAE;AAC7C,UAAI,UAAU,gCAAgC,wCAAwC;AAEtF,gBAAAC,QAAG,SAAS,WAAW,IAAI,KAAK,CAAC,KAAK,SAAS;AAC3C,YAAI,KAAK;AACL,cAAI,UAAU,GAAG;AACjB,cAAI,MAAM,mBAAmB,CAAAC,SAAO;AAChC,gBAAIA,MAAK;AACL,mBAAK,QAAQ,IAAI,MAAM,uBAAuBA,IAAG,EAAE;AAAA,YACvD;AACA,gBAAI,IAAI;AAAA,UAEZ,CAAC;AAAA,QACL,OAAO;AACH,cAAI,UAAU,KAAK;AAAA,YACf,gBAAgB;AAAA,YAChB,kBAAkB,KAAK;AAAA,YACvB,iBAAiB;AAAA,UACrB,CAAC;AACD,cAAI,MAAM,MAAM,CAAAA,SAAO;AACnB,gBAAIA,MAAK;AACL,mBAAK,QAAQ,IAAI,MAAM,uBAAuBA,IAAG,EAAE;AAAA,YACvD;AACA,gBAAI,IAAI;AAAA,UAEZ,CAAC;AAAA,QACL;AAAA,MACJ,CAAC;AAAA,IACL,CAAC,EACA,OAAO,MAAM,EAAE;AAAA,EACxB;AAAA,EACA,MAAM,SAAwB;AAC1B,SAAK,IAAI,MAAM,qBAAqB;AACpC,SAAK,OAAO,MAAM;AAAA,EACtB;AACJ;",
  "names": ["http", "fs", "err"]
}
